<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="css/main.css" rel="stylesheet">
    <!--Import Google Icon Font-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <!-- Datatable css -->
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.22/css/jquery.dataTables.css">
    <!--prism CSS-->
    <link  type="text/css" href="css/prism.css" rel="stylesheet" /> 
    <!--Font-->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Lato&family=Montserrat&family=Open+Sans&family=PT+Sans&family=Roboto&display=swap" rel="stylesheet">
</head>

<body>

    <header>
        <div class="navbar-fixed">
            <nav>
                <div class="nav-wrapper">
                    <div class="container">
                        <a href="#!" class="brand-logo">App Gestion Compte Administratif </a>
                        <a href="#" data-target="mobile-demo" class="sidenav-trigger"><i class="material-icons">menu</i></a>
                        <ul class="right hide-on-med-and-down">
                            <li><a href="#introduction">Introduction</a></li>
                            <li><a href="#application">Application</a></li>
                            <li><a href="#bdd">Base de données</a></li>
                            <li><a href="#interface">Interface</a></li>
                            <li><a href="#logiciel">BDD et Interface</a></li>
                        </ul>
                    </div>
                </div>
            </nav>
        </div>

        <ul class="sidenav" id="mobile-demo">
            <li><a href="#introduction">Introduction</a></li>
            <li><a href="#application">Application</a></li>
            <li><a href="#bdd">Base de données</a></li>
            <li><a href="#interface">Interface</a></li>
            <li><a href="#logiciel">BDD et Interface</a></li>
        </ul>
    </header>
    <section id="introduction" class="section container scrollspy">
        <h1>Introduction</h1>
        <p>Pour mettre en application les différents cours, 
            nous devons créer un logiciel de gestion administrative, 
            permettant d’afficher, d’ajouter, supprimer et 
            modifier des données d’une base de données avec une sécurité 
            par mot de passe lors de certaines opérations.</p>
        <h3>Cahier des Charges</h3>
        <ul class="browser-default">
            <li>
                <h6>Création de la base de données </h6>
                <p>Analysez le jeu de données fourni, décrivez les anomalies introduises par la conception initiale ; 
                    standardisez la base de données afin d’obtenir un schéma relationnel avec des relations en troisième forme normale ; 
                    créer la BD sous Oracle et la charger à partir des données fournies.</p>
            </li>
            <li>
                <h6>Création d’une interface</h6>
                <p>
                    Développer une interface interactive avec le langage Java qui permet un utilisateur de : (1) ajouter des nouveaux tuples en remplissant un formulaire ; 
                    (2) chercher des informations selon certaines critères (ex. en cochant des cases, ou en saisissant les valeurs de certains attributs), 
                    et (3) afficher les résultats dynamiquement. Pour le point (2), 
                    quelques besoins sont imposés et doivent être intégrées dans l’interface :
                </p>
                <ul class="browser-default">
                    <li>L'utilisateur doit pouvoir ajouter un nouvel enregistrement dans la base de données. Cette fonction doit être protégée par un mot de passe.</li>
                    <li>L'utilisateur doit pouvoir modifier les informations concernant un enregistrement. Cette fonction doit être protégée par un mot de passe.</li>
                    <li>L'utilisateur doit pouvoir supprimer un enregistrement. Cette fonction doit être protégée par un mot de passe.</li>
                    <li>L'utilisateur doit pouvoir trouver le montant total dépensé ou reçu par rapport à un chapitre ou un article.</li>
                    <li>L'utilisateur doit pouvoir trouver les informations pertinentes en précisant des critères de recherche via un formulaire.</li>
                </ul>
            </li>
            <li>
                <h6>Connecter la base de données à l’interface</h6>
                <p>Etablissez une connexion au serveur Oracle de l’UPS dans le programme, 
                    envoyer les requêtes reçues via l’interface au serveur, récupérer et afficher les résultats.</p>
            </li>
        </ul>
        <h3>Partage des tâches</h3>
        <table >
            <thead>
                <th >Tâche</th>
                <th class="check">Damien</th>
                <th class="check">Dang</th>
                <th class="check" >Matthieu</th>
                <th class="check">Stanley</th>
            </thead>
            <tbody>
                <tr>
                    <td>Standardisation de la base de données</td>
                    <td class="check"><i class="material-icons">close</i></td>
                    <td class="check"></td>
                    <td class="check"><i class="material-icons">close</i></td>
                    <td class="check"></td>
                </tr>
                <tr>
                    <td>Implémentation des tables</td>
                    <td class="check"><i class="material-icons">close</i></td>
                    <td class="check"></td>
                    <td class="check"></td>
                    <td class="check"><i class="material-icons">close</i></td>
                </tr>
                <tr>
                    <td>Interface</td>
                    <td class="check"></td>
                    <td class="check"><i class="material-icons">close</i></td>
                    <td class="check"></td>
                    <td class="check"><i class="material-icons">close</i></td>
                </tr>
                <tr>
                    <td>Ajouter un enregistrement</td>
                    <td class="check"><i class="material-icons">close</i></td>
                    <td class="check"></td>
                    <td class="check"><i class="material-icons">close</i></td>
                    <td class="check"></td>
                </tr>
                <tr>
                    <td>Modifier un enregistrement</td>
                    <td class="check"></td>
                    <td class="check"><i class="material-icons">close</i></td>
                    <td class="check"></td>
                    <td class="check"></td>
                </tr>
                <tr>
                    <td>Supprimer un enregistrement</td>
                    <td class="check"></td>
                    <td class="check"></td>
                    <td class="check"><i class="material-icons">close</i></td>
                    <td class="check"></td>
                </tr>
                <tr>
                    <td>Recherche par code chapitre/article</td>
                    <td class="check"></td>
                    <td class="check"><i class="material-icons">close</i></td>
                    <td class="check"></td>
                    <td class="check"><i class="material-icons">close</i></td>
                </tr>
                <tr>
                    <td>Recherche avancées</td>
                    <td class="check"></td>
                    <td class="check"></td>
                    <td class="check"></td>
                    <td class="check"><i class="material-icons">close</i></td>
                </tr>
            </tbody>
        </table>
        <h3>Livrables</h3>
        <table >
            <thead>
                <th>Tâche</th>
                <th class="check">Livrable</th>
                <th class="check">Non-Livrable</th>
            </thead>
            <tbody>
                <tr>
                    <td>Ajouter un enregistrement</td>
                    <td class="check"><i class="material-icons">check</i></td>
                    <td class="check"></td>
                </tr>
                <tr>
                    <td>Modifier un enregistrement</td>
                    <td class="check"><i class="material-icons">check</i></td>
                    <td class="check"></td>
                </tr>
                <tr>
                    <td>Supprimer un enregistrement</td>
                    <td class="check"><i class="material-icons">check</i></td>
                    <td class="check"></td>
                </tr>
                <tr>
                    <td>Recherche par code chapitre/article</td>
                    <td class="check"><i class="material-icons">check</i></td>
                    <td class="check"></td>
                </tr>
                <tr>
                    <td>Recherche avancées</td>
                    <td class="check"><i class="material-icons">check</i></td>
                    <td class="check"></td>
                </tr>
            </tbody>
        </table>
        <h3>Difficultés rencontrés</h3>
            <ul class="browser-default">
                <li>Trouver une clé lors de la standardisation (résolution: utilisation d'une clé primaire "imaginaire")</li>
                <li>La prise en main de java Swing</li>
            </ul>
        <h3>Utilisation de l'application</h3>
        <p>Télécharger le fichier zip à ouvrir avec Eclispse ou un autre IDE pour Java : <a href="contenu/interface_sgbd.zip">Telecharger</a></p>
        <p></p>Lors de la première utilisation ouvrir le fichier "conf.properties" pour entrer le login et le mot de passe à la base de oracle</p>
        <p></p>Mot de passe pour l'ajout/supression/Modification : 1234</p>

        <h3>Outils utilisés</h3>
        <ul class="browser-default">
            <li><a href="https://www.oracle.com/fr/database/technologies/appdev/jdbc-downloads.html" target="_blank">JDBC</a> Driver pour la connexion à la base de données d'oracle</li>
            <li><a href="https://www.eclipse.org/downloads/" target="_blank">Eclipse</a> pour l'IDE</li>
            <li><a href="https://www.invisionapp.com/studio" target="_blank">InVision</a> pour la création du mockup</li>
            <li><a href="https://www.oracle.com/fr/tools/downloads/sqldev-v192-downloads.html" target="_blank"> Sql Developer</a> pour la gestion de la base de données</li>
        </ul>
    </section>

    <!-- parallax -->
    <div class="parallax-container">
        <div class="parallax">
            <img src="contenu/images/bck1.jpg" alt="Photo de Karolina Grabowska provenant de Pexels" class="responsive-img">
        </div>
    </div>

    <section id="application" class="section container scrollspy">
       <h1>L'application</h1>
       <h3>Création de la base de données</h3>
       <p>Pour la création de la base on nous a donnés un document *.csv avec toutes données nécessaires pour construire/standardiser notre base de données en mettant en application les méthodes vues en cours.</p>
       <div class="table_container">
        <table id="example" class="compact stripe" style="width:100%">
                <thead>
                    <tr>
                        <th>Entite Financiere Programme</th>
                        <th>Nomenclature Comptable</th>
                        <th>DEPENSES_RECETTES</th>
                        <th>INVESTISSEMENT_FONCTIONNEMENT</th>
                        <th>Code Chapitre</th>
                        <th>Libelle Chapitre</th>
                        <th>Code Article</th>
                        <th>Libelle Article</th>
                        <th>Code Presentation Croisee</th>
                        <th>Libelle Presentation Croisee</th>
                        <th>ORDRE_REEL</th>
                        <th>MontantRealise</th>
                    </tr>
                </thead>
                <tfoot>
                    <tr>
                        <th>Entite Financiere Programme</th>
                        <th>Nomenclature Comptable</th>
                        <th>DEPENSES_RECETTES</th>
                        <th>INVESTISSEMENT_FONCTIONNEMENT</th>
                        <th>Code Chapitre</th>
                        <th>Libelle Chapitre</th>
                        <th>Code Article</th>
                        <th>Libelle Article</th>
                        <th>Code Presentation Croisee</th>
                        <th>Libelle Presentation Croisee</th>
                        <th>ORDRE_REEL</th>
                        <th>MontantRealise</th>
                    </tr>
                </tfoot>
            </table>
            <h4>Standardisation de la base de données</h4>
        <h6>1er étapes : identifiées les dépendances fonctionnelles</h6>
        <pre>
            EntitéFinanciereProgramme → NomenclatureComptable
            CodeChapitre → LibelleChapitre 
            CodeArticle → LibelleArticle
            CodePresentationCroisee → LibellePresentationCroisee 
        </pre>
        <h6>2eme étapes : Recherches d’anomalie</h6>
		<pre>
             Redondance des données
        </pre>
        <h6>3eme étapes : Recherches de la clé universelle</h6>
           
        <pre>
            Nous sommes parvenus à la clé suivante : 

            (EntitéFinanciereProgramme, Depense_Recette, CodeArticle, CodeChapitre, 
            CodePresentationProgramme, Ordre_Reel, Montant, Investissement_Financement)   

            Elle est relativement important nous avons donc suivi votre conseil est créer une clé artificielle 
            ID qui réuni les champs de la clé ci-dessus 
        </pre>
        <h6>4eme étape : Couverture Minimale</h6>
        <pre>
            ID→ EntitéFinanciereProgramme , Depense_Recette , CodeArticle , CodeChapitre , 
            CodePresentationProgramme , Ordre_Reel,Montant , Investissement_Financement , 
            NomenclatureComptable , LibelleChapitre ,LibelleArticle ,LibellePresentationCroisee 
            
            EntitéFinanciereProgramme → NomenclatureComptable 
            CodeChapitre → LibelleChapitre 
            CodeArticle → LibelleArticle 
            CodePresentationCroisee → LibellePresentationCroisee

        </pre>
        <h6>5 eme etape : Application de l’algorithme de décomposition</h6>
        <pre>

                    R(ID,EntitéFinanciereProgramme , Depense_Recette , CodeArticle , CodeChapitre , CodePresentationProgramme , Ordre_Reel,Montant ,
                    Investissement_Financement , NomenclatureComptable , LibelleChapitre ,LibelleArticle ,LibellePresentationCroisee) 
                    |                                                        |
R1(CodeArticle,LibelleArticle)      R’(ID,EntitéFinanciereProgramme , Depense_Recette , CodeArticle , CodeChapitre , 
                                    CodePresentationProgramme , Ordre_Reel,Montant , Investissement_Financement , 
                                    NomenclatureComptable , LibelleChapitre ,LibellePresentationCroisee)     
                                                |                                        |
                R2(EntitéFinanciereProgramme,NomenclatureComptable)    R’’(ID,EntitéFinanciereProgramme , Depense_Recette , 
                                                                        CodeArticle , CodeChapitre , CodePresentationProgramme , Ordre_Reel,Montant , 
                                                                        Investissement_Financement, LibelleChapitre ,LibellePresentationCroisee) 
                                                                              |                                      |
                                                     R3(CodeChapitre, LibelleChapitre)      R’’’(ID,EntitéFinanciereProgramme , Depense_Recette , CodeArticle , CodeChapitre , 
                                                                                            CodePresentationProgramme , Ordre_Reel,Montant , Investissement_Financement,
                                                                                            LibellePresentationCroisee)
                                                                                            |                                            |
                                                    R4(CodePresentationCroisee , LibellePresentationCroisee)  R5(ID,EntitéFinanciereProgramme , Depense_Recette , CodeArticle ,                
                                                                                                              CodeChapitre , CodePresentationProgramme , Ordre_Reel,Montant ,
                                                                                                              Investissement_Financement) 
        </pre>
        </div>  
    </section>
    
    <!-- parallax -->
    <div class="parallax-container">
        <div class="parallax">
            <img src="contenu/images/bck1.jpg" alt="Photo de Karolina Grabowska provenant de Pexels" class="responsive-img">
        </div>
    </div>

    <section id="bdd" class="section container scrollspy">
        
        <h4>Implémentation de la base de données</h4>
        <h5>Création des tables</h5>
        <pre>
            <code class="language-sql">
CREATE TABLE article (
    codeArticle number(12) NOT NULL,
    libelleArticle VARCHAR2(200) NOT NULL,
    CONSTRAINT pk_article PRIMARY KEY (codeArticle)
);
-- -------------------------------------------------------
CREATE TABLE chapitre (
    codeChapitre number(12) NOT NULL,
    libelleChapitre VARCHAR2(200) NOT NULL,
    CONSTRAINT pk_chapitre PRIMARY KEY (codeChapitre)
);
-- --------------------------------------------------------
CREATE TABLE entitefinanciereprogramme (
    EntiteFinanciereProgramme VARCHAR2(200) NOT NULL,
    NomenclatureComptable VARCHAR2(5) NOT NULL,
    CONSTRAINT pk_entite PRIMARY KEY (EntiteFinanciereProgramme)
);
-- --------------------------------------------------------
CREATE TABLE presentationcroisee (
    codePresentationCroisee number(12) NOT NULL,
    libellePresentationCroisee VARCHAR2(200) NOT NULL,
    CONSTRAINT pk_codePresentationCroisee PRIMARY KEY (codePresentationCroisee)
);
-- --------------------------------------------------------
CREATE TABLE compte_adm_tls (
    id number(12) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL ,
    ORDRE_REEL VARCHAR2(10) NOT NULL,
    DEPENSES_RECETTES VARCHAR2(10) NOT NULL,
    INVESTISSEMENT_FONCTIONNEMENT VARCHAR2(20) NOT NULL,
    CodeChapitre number(12) NOT NULL,
    CodeArticle number(12) NOT NULL,
    CodePresentationCroisee number(12) NOT NULL,
    EntiteFinanciereProgramme VARCHAR2(200) NOT NULL,
    MontantRealise FLOAT NOT NULL,
    CONSTRAINT pk_compte_admin_table PRIMARY KEY (id),
    CONSTRAINT fk_codeArticle FOREIGN KEY (CodeArticle) REFERENCES article (codeArticle),
    CONSTRAINT fk_codeChapitre FOREIGN KEY (CodeChapitre) REFERENCES chapitre (codeChapitre),
    CONSTRAINT fk_codePresetation FOREIGN KEY (CodePresentationCroisee) REFERENCES presentationcroisee (codePresentationCroisee),
    CONSTRAINT fk_entiteFinanciere FOREIGN KEY (EntiteFinanciereProgramme) REFERENCES entitefinanciereprogramme(EntiteFinanciereProgramme)
);
-- --------------------------------------------------------

COMMIT;
            </code>
         </pre>
         <h5>Insertion des données dans les tables depuis le .csv</h5>
         <p>Après insertion des données du fichier .csv dans la base de données à l’aide de sqlDeveloper on les récupère pour les insérer dans nos tables</p>
         <pre>
            <code class="language-sql">
INSERT INTO ARTICLE(codeArticle, libelleArticle)
SELECT DISTINCT codeArticle, libelleArticle FROM compte_adm_tls;

INSERT INTO CHAPITRE(codeChapitre, libelleChapitre)
SELECT DISTINCT codeChapitre, libelleChapitre FROM compte_adm_tls;

INSERT INTO PRESENTATIONCROISEE(codePresentationCroisee, libellePresentationCroisee)
SELECT DISTINCT codePresentationCroisee, libellePresentationCroisee FROM compte_adm_tls;

INSERT INTO ENTITEFINANCIEREPROGRAMME(entiteFinanciereProgramme, nomenclatureComptable)
SELECT DISTINCT entiteFinanciereProgramme, nomenclatureComptable FROM compte_adm_tls;

INSERT INTO COMPTE_ADMIN_TABLE
(Ordre_Reel,Depenses_Recettes,Investissement_Fonctionnement,codeChapitre,codeArticle,codePresentationCroisee,entiteFinanciereProgramme,montantRealise)
SELECT DISTINCT Ordre_Reel,Depenses_Recettes,Investissement_Fonctionnement,codeChapitre,codeArticle,codePresentationCroisee,entiteFinanciereProgramme,montantRealise  
FROM compte_adm_tls;

COMMIT;
            </code>
        </pre>
        <h4>La classe de la base de données </h4>
        <pre>
            <code class="language-java">
Class Database{
    public Connection connexionDatabase(); 
        permet la connexion à la base de données après récupérations des infos nécessaires dans le fichier config.properties  (Driver,login,…)

    public Connection fermerConnexion(); 
        fermeture de la connexion

    public ResultSet executerRequete(String sql); 
    	permet l’exécution d’une requête de type SELECT

    public String requeteUpdate(String sql);
    	permet l’exécution d’une requête de type (UPDATE, INSERT, DELETE);

    public ResultSet querySelectAll(String nomTable);
    	permet la récupération de toutes les données concernant nomTable

    public ResultSet querySelectAllOrderBy(String nomTable,String colonne);
    	permet la récupération de toutes les données concernant nomTable  et ordonnée avec colonne

    public ResultSet querySelectCol(String nomTable, String colonne);
    	permet la récupération de toutes les données concernant la colonne de nomTable 

    public ResultSet querySelectWhereColonneInt(String nomTable,String colonne ,int num);
    	permet la récupération de toutes les données correspondant à un code (num) de type int de la colonne codeArticle (colonne) de table article (nomTable) par exemple 

    public ResultSet querySelectWhereColonneString(String nomTable,String colonne ,String code)
    	pareil que pour la méthode au dessus sauf que le code est de type String

    public int querySelectGetTotalEnr();
    	permet de récupérer la dernière valeur de l’id de notre table principale

    public ResultSet querySelectbyArticle(int article);
    	permet la récupération des infos en fonction du codeArticle (article);

    public float querySelectbyArticleSum(int article, String d_r);
    	permet le calcul de la somme du montantRealisé en fonction du codeArticle (article) en les séparant par dépense et recette (d_r);
    
        public ResultSet querySelectbyChapitre(int chapitre);
    	permet la récupération des infos en fonction du codeArticle (chapitre);

    public float querySelectbyChapitreSum(int chapitre, String d_r);
    	permet le calcul de la somme du montantRealisé en fonction du codeArticle (chapitre) en les séparant par dépense et recette (d_r);
    	
    public ResultSet querySelectbyId(int id);
    	permet la récupération par numéro de l’id (méthode de test pas utilisé dans l’application);

    public ResultSet querySelectbyCodes(String e,String d_r, String i_f, int codechapitre,int codearticle,  int codepresentation,String o_r);
    	même  chose que au dessus mais permet la récupération des données avec les clés primaire (utilisé dans l’application);

    public String addToDatabase(String e,String d_r, String i_f, int codechapitre,int codearticle,  int codepresentation,String o_r,float montant);
    	permet  l’ajout d’un enregistrement dans la base de données

    public String deleteFromDatabase(int id);
	permet la supression d’un enregistrement de la table

    public String UpdateEnrDatabase(int id,String e,String d_r, String i_f, int codechapitre,int codearticle,  int codepresentation,String o_r,float montant);
    	permet la mise à jour d’un enregistrement de la table

    ResultSet filterSearch(Map<String, String> list);
    	permet la récupération de données en fonction des infos fournis par la liste
}
            </code>
        </pre>
    </section>

    <!-- parallax -->
    <div class="parallax-container">
        <div class="parallax">
            <img src="contenu/images/bck1.jpg" alt="Photo de Karolina Grabowska provenant de Pexels" class="responsive-img">
        </div>
    </div>

    <section id="interface" class="section container scrollspy">
        <h4>Interface Graphique</h4>
        <h5>Version web fait par Dang : <a href="https://supersieu.github.io/ConceptAdm/" target="_blank">Site</a></h5>
        <h5>Mockup fait avec inVision par Stanley</h5>
        
        <div class="container_image">
            <div class="image_text pt100">
                <p>Class MainJFrame.java (JFrame): Conteneur pour les JPanel</p>
            </div>
            <div class="image2">
                <img class="materialboxed" src="contenu/images/1.png" />
            </div>
        </div>
        
        <div class="container_image">
            <div  class="image_text pt100">
                <p>Class RechercheC.java (JPanel) : l’affichage des données en fonction du code article ou du code chapitre</p>
            </div>
            <div class="image2">
                <img class="materialboxed" src="contenu/images/2.1.png" />
            </div>
        </div>
        
        <div class="container_image">
            <div  class="image_text pt100">
                <p>Class RechercheA.java (JPanel) : affichages des données après précisons de certain critères</p>
            </div>
            <div class="image2">
                <img class="materialboxed" src="contenu/images/3_2.png" />
            </div>
        </div>
            
        <div class="container_image">
            <div  class="image_text ">
                <p>Class CRUD (JPanel): Conteneur pour les class Add_panel.java, Modif_panel.java, Delete_panel.java</p>
                <p> Class Add_panel.java (JPanel) : permet l’ajout de données dans la BDD</p>
                <p> Class Modif_panel.java (JPanel) : permet la modification de données dans la BDD</p>
                <p> Class Delete_panel.java (JPanel) : permet la supression de données dans la BDD</p>
            </div>
            <div class="image2">
                <img class="materialboxed" src="contenu/images/4.1.png" />
            </div>
        </div>
    </section>

    <!-- parallax -->
    <div class="parallax-container">
        <div class="parallax">
            <img src="contenu/images/bck1.jpg" alt="Photo de Karolina Grabowska provenant de Pexels" class="responsive-img">
        </div>
    </div>

    <section id="logiciel" class="section container scrollspy">
        <h4>Association Base de données/Interface</h4>
        
        <div class="container_image">
        <h5>Recherche par code</h5>
        <div class="container_image">
            <div class="image_text pt100">
                <p> On fonction du radio button choisie on remplie la JCombobox avec les codes article ou codes chapitre et en fonction du code choisie on affiche 
                le libéllé correspondant et on remplie le tableau avec les infos correspondantes</p>
            </div>
            <div  class="image_code">
                <img class="materialboxed" src="contenu/images/RechercheC.png" />
            </div>
        </div>
            <div style="width:90%" class="">
               <pre >
                   <code class="language-java">
public ResultSet querySelectbyChapitre(int chapitre) {
    String sql = "SELECT c.id,e.ENTITEFINANCIEREPROGRAMME,e.nomenclaturecomptable,c.depenses_recettes,c.investissement_fonctionnement"
    + ",c.codechapitre,ch.libellechapitre,c.codearticle, a.libellearticle,c.codepresentationcroisee,p.libellepresentationcroisee,"
    + "c.ordre_reel,c.montantrealise FROM compte_adm_tls1 c,article a,chapitre ch,entitefinanciereprogramme e ,presentationcroisee p"
    + " WHERE c.codechapitre="+chapitre
    + " and c.codearticle = a.codearticle"
    + " and c.codechapitre = ch.codechapitre"
    + " and c.entitefinanciereprogramme = e.ENTITEFINANCIEREPROGRAMME"
    + " and c.codepresentationcroisee = p.codepresentationcroisee ORDER BY c.id";
    return this.executerRequete(sql);
}

public ResultSet querySelectbyArticle(int article) {
    String sql = "SELECT c.id,e.ENTITEFINANCIEREPROGRAMME,e.nomenclaturecomptable,c.depenses_recettes,c.investissement_fonctionnement,"
    + " c.codechapitre,ch.libellechapitre,c.codearticle, a.libellearticle,c.codepresentationcroisee,p.libellepresentationcroisee,c.ordre_reel,c.montantrealise "
    + "FROM compte_adm_tls1 c,article a,chapitre ch,entitefinanciereprogramme e ,presentationcroisee p"
    + " WHERE c.codearticle="+article
    + " and c.codearticle = a.codearticle"
    + " and c.codechapitre = ch.codechapitre"
    + " and c.entitefinanciereprogramme = e.ENTITEFINANCIEREPROGRAMME"
    + " and c.codepresentationcroisee = p.codepresentationcroisee ORDER BY c.id";
    return this.executerRequete(sql);
}            

//Recherche du libelle
public ResultSet querySelectWhereColonneInt(String nomTable,String colonne ,int num) {
    String sql= "SELECT * FROM "+ nomTable + " WHERE "+ colonne+ "="+num;
    return this.executerRequete(sql);
}

//Somme des depense ou recette pour Article même code pour chapitre
public float querySelectbyArticleSum(int article, String d_r) {
    float result = 0;
    //connexionDatabase();
    String sql = "SELECT SUM(c.montantrealise)"
            +" FROM compte_adm_tls1 c,article a,chapitre ch,entitefinanciereprogramme e ,presentationcroisee p"
            +" WHERE c.codearticle="+article
            +" and c.depenses_recettes= '"+d_r+"'"
            +" and c.codearticle = a.codearticle"
            +" and c.codechapitre = ch.codechapitre"
            +" and c.entitefinanciereprogramme = e.ENTITEFINANCIEREPROGRAMME"
            +" and c.codepresentationcroisee = p.codepresentationcroisee ORDER BY c.id";
    ResultSet rs = executerRequete(sql);
    try {	
        while (rs.next()) {
            result = rs.getFloat(1);
        }
    } catch (SQLException e) {
        e.printStackTrace();
    }
    return result;
}
                   </code>
               </pre>
            </div>
        </div>
        <div class="container_image">
            <h5>Recherche Avancée</h5>
            <div style="width:90%" class="image_code">
                <figure>
                    <img style="width:100%" class="materialboxed" src="contenu/images/RechercheA1.png" />
                    <figcaption >Image 1 : Sélection d'un code aprés chargement de la JCombobox dans l'image on sélectionne le code chapitre 11 donc la JTable 
                        est remplie avec les enregistrement ayant le code chapitre 11
                        Code sql retourné par la fonction <a href="#code_rech">filterSearch()</a></p>
                    
                

                <pre >
                    <code  class="language-sql">
SELECT 
c.id, e.ENTITEFINANCIEREPROGRAMME,e.nomenclaturecomptable,c.depenses_recettes,c.investissement_fonctionnement,c.codechapitre,
ch.libellechapitre,c.codearticle, a.libellearticle,c.codepresentationcroisee,p.libellepresentationcroisee,	c.ordre_reel,c.montantrealise 
FROM compte_adm_tls1 c 
INNER  JOIN article a ON a.codearticle = c.codearticle 
INNER  JOIN chapitre ch ON ch.codechapitre = c.codechapitre 
INNER  JOIN entitefinanciereprogramme e ON e.ENTITEFINANCIEREPROGRAMME = c.ENTITEFINANCIEREPROGRAMME 
INNER  JOIN presentationcroisee p ON p.codepresentationcroisee = c.codepresentationcroisee   
WHERE  c.codechapitre = 11 order by c.id
                    </code>
                </pre>
            </figcaption>
        </figure>
            </div>
            <div style="width:90%" class="image_code">
                <figure>
                    <img style="width:100%" class="materialboxed" src="contenu/images/RechercheA2.png" />
                    <figcaption>Image 2 : On ajoute le code Presentation croisee 20 
                        Code sql retourné par la fonction <a href="#code_rech">filterSearch()</a>
                    
                
                 <pre>
                    <code  class="language-sql">
SELECT 
c.id, e.ENTITEFINANCIEREPROGRAMME,e.nomenclaturecomptable,c.depenses_recettes,c.investissement_fonctionnement,c.codechapitre,
ch.libellechapitre,c.codearticle, a.libellearticle,c.codepresentationcroisee,p.libellepresentationcroisee,	c.ordre_reel,c.montantrealise 
FROM compte_adm_tls1 c 
INNER  JOIN article a ON a.codearticle = c.codearticle 
INNER  JOIN chapitre ch ON ch.codechapitre = c.codechapitre 
INNER  JOIN entitefinanciereprogramme e ON e.ENTITEFINANCIEREPROGRAMME = c.ENTITEFINANCIEREPROGRAMME 
INNER  JOIN presentationcroisee p ON p.codepresentationcroisee = c.codepresentationcroisee   
WHERE  c.codechapitre = 11 and c.codepresentationcroisee = 20 order by c.id
                    </code>
                </pre>
            </figcaption>
        </figure>
            </div>
            <div style="width:90%" class="image_code">
                <figure>
                    <img style="width:100%" class="materialboxed" src="contenu/images/RechercheA3.png" />
                    <figcaption>Image 3 : On ajoute un montant maximum à l'aide du JSlider puis on appuie sur le bouton filterSearch
                        Code sql retourné par la fonction <a href="#code_rech">filterSearch()</a>
                   
                
                <pre>
                    <code  class="language-sql">
SELECT 
c.id, e.ENTITEFINANCIEREPROGRAMME,e.nomenclaturecomptable,c.depenses_recettes,c.investissement_fonctionnement,c.codechapitre,
ch.libellechapitre,c.codearticle, a.libellearticle,c.codepresentationcroisee,p.libellepresentationcroisee,	c.ordre_reel,c.montantrealise 
FROM compte_adm_tls1 c 
INNER  JOIN article a ON a.codearticle = c.codearticle 
INNER  JOIN chapitre ch ON ch.codechapitre = c.codechapitre 
INNER  JOIN entitefinanciereprogramme e ON e.ENTITEFINANCIEREPROGRAMME = c.ENTITEFINANCIEREPROGRAMME 
INNER  JOIN presentationcroisee p ON p.codepresentationcroisee = c.codepresentationcroisee   
WHERE  c.codechapitre = 11 and c.codepresentationcroisee = 20  and  c.montantrealise < 15000 order by c.id
                    </code>
                </pre>
            </figcaption>  
        </figure>
            </div>
            <div style="width:90%" class="">
                <p>A chaque JCombobox remplie on ajoute une condition a la requête</p>
                <pre id="code_rech">
                    <code class="language-java">
public ResultSet filterSearch(Map<String, String> list) {
    int i=0;
    int max = 0;
    int min = 0;
    boolean test = false;
    String sql = "SELECT c.id,e.ENTITEFINANCIEREPROGRAMME,e.nomenclaturecomptable,c.depenses_recettes,c.investissement_fonctionnement,c.codechapitre,ch.libellechapitre,c.codearticle, a.libellearticle,c.codepresentationcroisee,p.libellepresentationcroisee,"
    + " c.ordre_reel,c.montantrealise FROM compte_adm_tls1 c"
    + " INNER  JOIN article a ON a.codearticle = c.codearticle"
    + " INNER  JOIN chapitre ch ON ch.codechapitre = c.codechapitre"
    + " INNER JOIN entitefinanciereprogramme e ON e.ENTITEFINANCIEREPROGRAMME = c.ENTITEFINANCIEREPROGRAMME"
    + " INNER  JOIN presentationcroisee p ON p.codepresentationcroisee = c.codepresentationcroisee  ";
    
    for (Map.Entry<String, String> entry : list.entrySet()) {
    if (i == 0 && entry.getValue() != "" && entry.getValue() != "0" ) {
                    sql+=" WHERE ";
        }
        if (entry.getKey().startsWith("code")  && entry.getKey()!= "max" && entry.getKey() != "min") {
            if (Integer.valueOf(entry.getValue()) != 0) {
                test =true;
                    sql+=" c."+ entry.getKey() +" = "+Integer.valueOf(entry.getValue());   
    }
                    
    }
    if (!(entry.getKey().startsWith("code")) && entry.getKey()!= "max" && entry.getKey() != "min") {
    if (!entry.getValue().isEmpty()) {
                test =true;
                    sql+=" c."+entry.getKey() +" = '"+entry.getValue()+"'";	
                }
        }                    
    if ( i < list.size()-1 && entry.getValue() != "" && entry.getValue() != "0") {
            if (test && !entry.getValue().isEmpty() && entry.getValue() != "0") {
                sql+=" and ";
                }
                        test = false; 	
    }
    if (entry.getKey() == "max" ) {
    max = Integer.valueOf(entry.getValue());
        }
    if (entry.getKey() == "min" ) {
            min = Integer.valueOf(entry.getValue());
        }
        i++;
    }
    if (test == true && (max >0 || min>0)) {
                    sql+=" and ";
    }
    if (max >0 && min > 0) {
        sql+=" c.montantrealise BETWEEN "+ min +" AND "+max;
    }else if (max > 0) {
        sql +=" c.montantrealise <"+ max;
    }else if(min > 0) {
    sql+=" c.montantrealise >"+ min;
    }
        sql = sql.replaceAll("(\\s+(and|WHERE)\\s*)$", "");
        sql+=  " order by c.id";
        return this.executerRequete(sql);
}                         
                    </code>
                </pre>
            </div>
        </div>
        <div class="container_image">
            <h5>Ajout/Modification/Supression</h5>
            <div class="image_code">
                <figure>
                    <img style="width:100%" class="materialboxed" src="contenu/images/CRUD1.png" />
                    <figcaption>Image 1 : Selection des differentes valeurs pour l'ajout d'un enregistrement dans la base</figcaption>
                </figure>         
            </div>
            <div class="image_code">
                <figure>
                    <img style="width:100%" class="materialboxed" src="contenu/images/CRUD2.png" />
                    <figcaption>Image 2 : Apres selection des differentes données et ajout du montant lors de l'appuie sue le bouton "AJOUTER" un mot de passe est demandé</figcaption>
                </figure>         
            </div>
            <div class="image_code">
                <figure>
                    <img style="width:100%" class="materialboxed" src="contenu/images/CRUD3.png" />
                    <figcaption>Image 3 : Pour la modification et la supression même systeme que pour l'ajout sauf qu'il a un bouton recherche pour etre sur que l'enregistrement existe en base </figcaption>
                </figure>  
            </div>
            <div class="image_code">
                <figure>
                    <img style="width:100%" class="materialboxed" src="contenu/images/CRUD3_1.png" />
                    <figcaption>Image 4 : Message d'eereur quand l'enregistrement à modifier ou supprimer n'existe pas en base </figcaption>
                </figure>
                
                
            </div>
        </div>
        Code pour l'ajout d'un enregistrement
        <pre id="code_rech">
            <code class="language-java">
public String addToDatabase(String e,String d_r, String i_f, int codechapitre,int codearticle,  int codepresentation,String o_r,float montant) {
    String sql= "INSERT INTO COMPTE_ADM_TLS1(ordre_reel,depenses_recettes,investissement_fonctionnement,codechapitre,codearticle,codepresentationcroisee,ENTITEFINANCIEREPROGRAMME,"
        + "montantrealise)  VALUES('"+o_r+"', '"+d_r+"', '"+i_f+"',"+codechapitre+","+codearticle+","+codepresentation+",'"+e+"',"+montant+")";
    return this.requeteUpdate(sql);
}
            </code>
        </pre>
        Code pour la modification d'un enregistrement
        <pre id="code_rech">
            <code class="language-java">
public String deleteFromDatabase(int id) {
    String sql= "DELETE FROM COMPTE_ADM_TLS1 WHERE id="+id;
    return this.requeteUpdate(sql);
}
            </code>
        </pre>
        Code pour la supression d'un enregistrement
        <pre id="code_rech">
            <code class="language-java">
public String UpdateEnrDatabase(int id,String e,String d_r, String i_f, int codechapitre,int codearticle,  int codepresentation,String o_r,float montant) {
    //connexionDatabase();
    String sql= "UPDATE COMPTE_ADM_TLS1"
            + " SET ordre_reel= '"+o_r+"'"
            + " ,depenses_recettes= '"+d_r+"'"
            + " ,investissement_fonctionnement= '"+i_f+"'"
            + " ,codechapitre= "+codechapitre
            + " ,codearticle= "+codearticle
            + " ,codepresentationcroisee= "+codepresentation
            + " ,ENTITEFINANCIEREPROGRAMME= '"+e+"'"
            + " ,montantrealise= "+montant
            + " WHERE id="+id;
    return this.requeteUpdate(sql);
}
            </code>
        </pre>
    </section>

    <footer class="page-footer">
        <div class="">
          <div class="container">
            © 2020 Copyright 
            <a class="grey-text text-lighten-3 right p5" href="https://github.com/Huze-UPS">Damien</a>
            <a class="grey-text text-lighten-3 right p5" href="https://github.com/supersieu">Dang</a> 
            <a class="grey-text text-lighten-3 right p5" href="https://github.com/likou31">Matthieu</a>
            <a class="grey-text text-lighten-3 right p5" href="https://github.com/stanBPS">Stanley</a>
          </div>
        </div>
      </footer>

    <!-- minified Jquery -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <!-- DATATABLE JS -->
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.js"></script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/buttons/1.6.5/js/dataTables.buttons.min.js"></script>
    <script type="text/javascript" charset="utf8" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script type="text/javascript" charset="utf8" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script type="text/javascript" charset="utf8" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.html5.min.js"></script>
    <!--Prism JS-->
    <script src="js/prism.js"></script> 
    <!-- Local JS File -->
    <script src="js/index.js"></script>
</body>

</html>